!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(require("FroalaEditor")):"function"==typeof define&&define.amd?define(["FroalaEditor"],t):t(e.$.FroalaEditor)}(this,function(m){"use strict";m=m&&m.hasOwnProperty("default")?m["default"]:m,Object.assign(m.DEFAULTS,{lineBreakerTags:["table","hr","form","dl","span.fr-video",".fr-embedly"],lineBreakerOffset:15,lineBreakerHorizontalOffset:10}),m.PLUGINS.lineBreaker=function(g){var d,t,a,c=g.$;function s(e,t){var n,r,a,o,i,s,f,l;if(null==e)i=(o=t.parent()).offset().top,n=(f=t.offset().top)-Math.min((f-i)/2,g.opts.lineBreakerOffset),a=o.outerWidth(),r=o.offset().left;else if(null==t)(s=(o=e.parent()).offset().top+o.outerHeight())<(l=e.offset().top+e.outerHeight())&&(s=(o=c(o).parent()).offset().top+o.outerHeight()),n=l+Math.min(Math.abs(s-l)/2,g.opts.lineBreakerOffset),a=o.outerWidth(),r=o.offset().left;else{o=e.parent();var p=e.offset().top+e.height(),u=t.offset().top;if(u<p)return!1;n=(p+u)/2,a=o.outerWidth(),r=o.offset().left}g.opts.iframe&&(r+=g.$iframe.offset().left-g.helpers.scrollLeft(),n+=g.$iframe.offset().top-g.helpers.scrollTop()),g.$box.append(d),d.css("top",n-g.win.pageYOffset),d.css("left",r-g.win.pageXOffset),d.css("width",a),d.data("tag1",e),d.data("tag2",t),d.addClass("fr-visible").data("instance",g)}function f(e){if(e){var t=c(e);if(!g.$el.contains(e))return null;if(e.nodeType!=Node.TEXT_NODE&&t.is(g.opts.lineBreakerTags.join(",")))return t;if(0<t.parents(g.opts.lineBreakerTags.join(",")).length)return e=t.parents(g.opts.lineBreakerTags.join(",")).get(0),g.$el.contains(e)&&c(e).is(g.opts.lineBreakerTags.join(","))?c(e):null}return null}function o(e,t){var n=g.doc.elementFromPoint(e,t);return n&&!c(n).closest(".fr-line-breaker").length&&!g.node.isElement(n)&&n!=g.$wp.get(0)&&function(e){if("undefined"!=typeof e.inFroalaWrapper)return e.inFroalaWrapper;for(var t=e;e.parentNode&&e.parentNode!==g.$wp.get(0);)e=e.parentNode;return t.inFroalaWrapper=e.parentNode==g.$wp.get(0),t.inFroalaWrapper}(n)?n:null}function i(e,t,n){for(var r=n,a=null;r<=g.opts.lineBreakerOffset&&!a;)(a=o(e,t-r))||(a=o(e,t+r)),r+=n;return a}function l(e,t,n){for(var r=null,a=100;!r&&e>g.$box.offset().left&&e<g.$box.offset().left+g.$box.outerWidth()&&0<a;)(r=o(e,t))||(r=i(e,t,5)),"left"==n?e-=g.opts.lineBreakerHorizontalOffset:e+=g.opts.lineBreakerHorizontalOffset,a-=g.opts.lineBreakerHorizontalOffset;return r}function n(e){var t=a=null,n=null,r=g.doc.elementFromPoint(e.pageX-g.win.pageXOffset,e.pageY-g.win.pageYOffset);r&&("HTML"==r.tagName||"BODY"==r.tagName||g.node.isElement(r)||0<=(r.getAttribute("class")||"").indexOf("fr-line-breaker"))?((n=i(e.pageX-g.win.pageXOffset,e.pageY-g.win.pageYOffset,1))||(n=l(e.pageX-g.win.pageXOffset-g.opts.lineBreakerHorizontalOffset,e.pageY-g.win.pageYOffset,"left")),n||(n=l(e.pageX-g.win.pageXOffset+g.opts.lineBreakerHorizontalOffset,e.pageY-g.win.pageYOffset,"right")),t=f(n)):t=f(r),t?function(e,t){var n,r,a=e.offset().top,o=e.offset().top+e.outerHeight();if(Math.abs(o-t)<=g.opts.lineBreakerOffset||Math.abs(t-a)<=g.opts.lineBreakerOffset)if(Math.abs(o-t)<Math.abs(t-a)){for(var i=(r=e.get(0)).nextSibling;i&&i.nodeType==Node.TEXT_NODE&&0===i.textContent.length;)i=i.nextSibling;if(!i)return s(e,null);if(n=f(i))return s(e,n)}else{if(!(r=e.get(0)).previousSibling)return s(null,e);if(n=f(r.previousSibling))return s(n,e)}d.removeClass("fr-visible").removeData("instance")}(t,e.pageY):g.core.sameInstance(d)&&d.removeClass("fr-visible").removeData("instance")}function e(e){return!(d.hasClass("fr-visible")&&!g.core.sameInstance(d))&&(g.popups.areVisible()||g.el.querySelector(".fr-selected-cell")?(d.removeClass("fr-visible"),!0):void(!1!==t||g.edit.isDisabled()||(a&&clearTimeout(a),a=setTimeout(n,30,e))))}function r(){a&&clearTimeout(a),d.hasClass("fr-visible")&&d.removeClass("fr-visible").removeData("instance")}function p(){t=!0,r()}function u(){t=!1}function v(e){e.preventDefault();var t=d.data("instance")||g;d.removeClass("fr-visible").removeData("instance");var n=d.data("tag1"),r=d.data("tag2"),a=g.html.defaultTag();null==n?a&&"TD"!=r.parent().get(0).tagName&&0===r.parents(a).length?r.before("<"+a+">"+m.MARKERS+"<br></"+a+">"):r.before(m.MARKERS+"<br>"):a&&"TD"!=n.parent().get(0).tagName&&0===n.parents(a).length?n.after("<"+a+">"+m.MARKERS+"<br></"+a+">"):n.after(m.MARKERS+"<br>"),t.selection.restore()}return{_init:function(){if(!g.$wp)return!1;g.shared.$line_breaker||(g.shared.$line_breaker=c('<div class="fr-line-breaker"><a class="fr-floating-btn" role="button" tabIndex="-1" title="'+g.language.translate("Break")+'"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><rect x="21" y="11" width="2" height="8"/><rect x="14" y="17" width="7" height="2"/><path d="M14.000,14.000 L14.000,22.013 L9.000,18.031 L14.000,14.000 Z"/></svg></a></div>')),d=g.shared.$line_breaker,g.events.on("shared.destroy",function(){d.html("").removeData().remove(),d=null},!0),g.events.on("destroy",function(){c("body").first(d.removeData("instance").removeClass("fr-visible")),clearTimeout(a)},!0),g.events.$on(d,"mousemove",function(e){e.stopPropagation()},!0),g.events.bindClick(d,"a",v),t=!1,g.events.$on(g.$win,"mousemove",e),g.events.$on(c(g.win),"scroll",r),g.events.on("popups.show.table.edit",r),g.events.on("commands.after",r),g.events.$on(c(g.win),"mousedown",p),g.events.$on(c(g.win),"mouseup",u)}}}});